# Instruction

## Rational
Due to docker image "openjdk:8-jre-alpine" has vulnerability issue on freetype lib, this is to
upgrade freetype to 2.9.2-r3 version of the image and create a new image which only has r3 version.

The reason to pre-build the image is that corporate firewall blocks 'apk upgrade' from the target container's host server.

## Pre-built the image

* Dockerfile content named upgrade-free-Dockerfile

```shell
FROM openjdk:8-jre-alpine
RUN apk upgrade freetype=2.9.2-r3
```

* Build image from the above Dockerfile

```shell
docker build --file upgrade-freetype-Dockerfile -t georgezhou888/openjdk:8-jre-alpine-freetype-r3-upgrade .
```

## Quick Run
For quick run, just run restore.sh and ignoring the rest in this readme and follow my previous email instruction

```shell
./restore.sh
```

## Deep dive

### Restore Images due to github 50M soft restriction (100M hard restriction)

* Restore Upgrade Image
```shell
cat upgrade.parta* > gz888-alpine-freetype-r3-upgrade.tar
```

* Restore Add Image
```shell
cat add.parta* > gz888-alpine-freetype-r3-add.tar
```


### Load Images Back

* Load upgrade image
```shell
docker load -i gz888-alpine-freetype-r3-upgrade.tar
```

* Load add image
```shell
docker load -i gz888-alpine-freetype-r3-upgrade.tar
```


###* See previous note to run, or re-tag the images

## Other Info

### Split Images
```shell
split -b 50M gz888-alpine-freetype-r3-upgrade.tar "upgrade.part"
split -b 50M gz888-alpine-freetype-r3-add.tar "add.part"
```
